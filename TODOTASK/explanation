# Complete Node.js + Express Beginner's Guide

## Table of Contents
1. [What This Application Does](#what-this-application-does)
2. [Complete Code Overview](#complete-code-overview)
3. [Detailed Code Breakdown](#detailed-code-breakdown)
4. [Understanding Routes](#understanding-routes)
5. [Function Formats & Modern Alternatives](#function-formats--modern-alternatives)
6. [Request Flow Diagram](#request-flow-diagram)
7. [Project Structure](#project-structure)
8. [How to Run](#how-to-run)

---

## What This Application Does

This is a **Node.js + Express.js** web application that creates a simple note-taking system with three main features:

- ðŸ“‹ Shows a list of all text files
- ðŸ‘€ Lets you view individual file contents
- âœï¸ Lets you create new text files

---

## Complete Code Overview

```javascript
const express = require('express');             // Framework to create web servers easily
const app = express();                          // Your actual web application
const path = require('path');                   // Helps work with file paths safely
const fs = require('fs');                       // Lets Node.js read/write files

app.set("view engine","ejs");

app.use(express.json());                        // Read JSON data
app.use(express.urlencoded({extended: true}));  // Read Form data

app.use(express.static(path.join(__dirname,"public")));

// Route 1: Homepage - Show all files
app.get('/',function(req,res){
    fs.readdir(`./files`,function(err, files){
         res.render("index",{files: files});
    })
})

// Route 2: View a specific file
app.get('/files/:filename',function(req,res){
    fs.readFile(`./files/${req.params.filename}`, "utf-8", function(err,filedata){
        res.render('show', {filename: req.params.filename, filedata:filedata});
    })
})

// Route 3: Create a new file
app.post('/create',function(req,res){
    fs.writeFile(`./files/${req.body.title.split(' ').join('')}.txt`, req.body.details, function(err){
        res.redirect("/")
    });
})

app.listen(3000);
```

---

## Detailed Code Breakdown

### 1. Setup & Imports

```javascript
const express = require('express');
const app = express();
const path = require('path');
const fs = require('fs');
```

| Module    | Purpose                               | Example Use                      |
|--------   |---------------------------------------|----------------------------------|
| `express` | Framework to build web servers easily | `app.get()`, `app.post()`        |
| `app`     | Your actual web application instance  | Routes, middleware, settings     |
| `path`    | Handle file paths safely across OS    | `path.join(__dirname, 'public')` |
| `fs`      | File System - read/write files        | `fs.readdir()`, `fs.writeFile()` |

---

### 2. Configuration

#### Set Template Engine
```javascript
app.set("view engine","ejs");
```
- Sets **EJS** (Embedded JavaScript) as the template engine
- EJS lets you write HTML with embedded JavaScript to display dynamic data
- Templates should be in a `views` folder

#### Middleware for Parsing Data
```javascript
app.use(express.json());                        // Parse JSON data
app.use(express.urlencoded({extended: true}));  // Parse form data
```

**What is Middleware?**
- Functions that process requests before they reach your routes
- Think of them as "checkpoints" that prepare data

| Middleware | What It Does | When Used |
|------------|--------------|-----------|
| `express.json()` | Parses JSON from request body | API calls, AJAX requests |
| `express.urlencoded()` | Parses form data | HTML form submissions |

#### Serve Static Files
```javascript
app.use(express.static(path.join(__dirname,"public")));
```
- Serves CSS, images, JavaScript files from the `public` folder
- `__dirname` = current directory where this file is located
- Example: `public/style.css` â†’ accessible at `http://localhost:3000/style.css`

---

### 3. Routes - The Main Logic

#### Route 1: Homepage - Show All Files

```javascript
app.get('/',function(req,res){
    fs.readdir(`./files`,function(err, files){
         res.render("index",{files: files});
    })
})
```

**Step-by-step breakdown:**

1. **`app.get('/', ...)`**
   - Listen for GET requests to homepage (`/`)
   - GET = User visits URL in browser

2. **`function(req, res)`**
   - **Callback function** (route handler)
   - `req` = Request object (what user sent)
   - `res` = Response object (what you send back)

3. **`fs.readdir('./files', ...)`**
   - Reads all filenames from `./files` folder
   - **Asynchronous** - doesn't block other code

4. **`function(err, files)`**
   - Another callback! Called when reading is done
   - `err` = Error (if something went wrong)
   - `files` = Array of filenames like `['note1.txt', 'note2.txt']`

5. **`res.render("index", {files: files})`**
   - Renders `views/index.ejs` template
   - Passes `files` array to the template
   - Sends HTML to user

---

#### Route 2: View a Specific File

```javascript
app.get('/files/:filename',function(req,res){
    fs.readFile(`./files/${req.params.filename}`, "utf-8", function(err,filedata){
        res.render('show', {filename: req.params.filename, filedata:filedata});
    })
})
```

**Understanding URL Parameters:**

- **`:filename`** is a **dynamic parameter**
- Example URL: `http://localhost:3000/files/mynote.txt`
- `req.params.filename` = `"mynote.txt"`

**Step-by-step:**

1. User visits `/files/mynote.txt`
2. `:filename` captures `"mynote.txt"`
3. `fs.readFile()` reads that specific file
4. `"utf-8"` = Read as text (not binary)
5. `filedata` contains the file's content
6. Render `show.ejs` with filename and content

---

#### Route 3: Create a New File

```javascript
app.post('/create',function(req,res){
    fs.writeFile(`./files/${req.body.title.split(' ').join('')}.txt`, req.body.details, function(err){
        res.redirect("/")
    });
})
```

**Understanding Form Data:**

- **POST request** = Form submission
- `req.body.title` = Form field named "title"
- `req.body.details` = Form field named "details"

**String Manipulation:**
```javascript
req.body.title.split(' ').join('')
```
- `.split(' ')` = Split by spaces â†’ `["My", "Note"]`
- `.join('')` = Join without spaces â†’ `"MyNote"`
- Result: `"My Note"` becomes `"MyNote.txt"`

**Step-by-step:**

1. User submits a form to `/create`
2. Get title and details from form
3. Remove spaces from title
4. Create a `.txt` file with the content
5. Redirect user back to homepage

---

### 4. Start the Server

```javascript
app.listen(3000);
```

- Starts the server on **port 3000**
- Access at: `http://localhost:3000`

**Better version with callback:**
```javascript
app.listen(3000, () => {
    console.log("Server running on http://localhost:3000");
});
```

---

## Understanding Routes

### Route Format

```javascript
app.METHOD(PATH, HANDLER_FUNCTION)
```

| Part | Description | Examples |
|------|-------------|----------|
| **METHOD** | HTTP method | `get`, `post`, `put`, `delete` |
| **PATH** | URL pattern | `'/'`, `'/about'`, `'/files/:id'` |
| **HANDLER** | Function to execute | `function(req, res) {...}` |

### Common HTTP Methods

| Method | Purpose | Example Use |
|--------|---------|-------------|
| `GET` | Retrieve data | View a page, get list of items |
| `POST` | Create new data | Submit a form, create a file |
| `PUT` | Update existing data | Edit a note |
| `DELETE` | Remove data | Delete a file |

---

## Function Formats & Modern Alternatives

### Original Style: Callback Functions (Your Code)

```javascript
app.get('/', function(req, res) {
    fs.readdir(`./files`, function(err, files) {
        res.render("index", {files: files});
    })
})
```

**Problems:**
- Nested callbacks (hard to read)
- Called "Callback Hell"
- Error handling is messy

---

### Option 1: Named Functions (Cleaner)

```javascript
function handleHomepage(req, res) {
    fs.readdir(`./files`, sendFilesToUser);
    
    function sendFilesToUser(err, files) {
        if (err) {
            return res.status(500).send("Error reading files");
        }
        res.render("index", {files: files});
    }
}

app.get('/', handleHomepage);
```

**Benefits:**
- More readable
- Functions have meaningful names
- Easier to debug

---

### Option 2: Arrow Functions (Modern)

```javascript
app.get('/', (req, res) => {
    fs.readdir(`./files`, (err, files) => {
        if (err) {
            return res.status(500).send("Error reading files");
        }
        res.render("index", {files: files});
    });
});
```

**Benefits:**
- Shorter syntax
- Modern JavaScript (ES6+)
- Still has nesting though

---

### Option 3: Async/Await (BEST & RECOMMENDED!)

```javascript
const fsPromises = require('fs').promises;

app.get('/', async (req, res) => {
    try {
        const files = await fsPromises.readdir('./files');
        res.render("index", {files: files});
    } catch (err) {
        res.status(500).send("Error reading files");
    }
});
```

**Benefits:**
- âœ… No nested callbacks
- âœ… Reads like normal code (top to bottom)
- âœ… Easy error handling with try/catch
- âœ… Much easier to understand

**All Routes with Async/Await:**

```javascript
const fsPromises = require('fs').promises;

// Route 1: Homepage
app.get('/', async (req, res) => {
    try {
        const files = await fsPromises.readdir('./files');
        res.render("index", {files: files});
    } catch (err) {
        res.status(500).send("Error reading files");
    }
});

// Route 2: View file
app.get('/files/:filename', async (req, res) => {
    try {
        const filedata = await fsPromises.readFile(`./files/${req.params.filename}`, 'utf-8');
        res.render('show', {
            filename: req.params.filename,
            filedata: filedata
        });
    } catch (err) {
        res.status(404).send("File not found");
    }
});

// Route 3: Create file
app.post('/create', async (req, res) => {
    try {
        const filename = req.body.title.split(' ').join('') + '.txt';
        await fsPromises.writeFile(`./files/${filename}`, req.body.details);
        res.redirect("/");
    } catch (err) {
        res.status(500).send("Error creating file");
    }
});
```

---

## Request Flow Diagram

### Visual Flow for Homepage Route

```
1. User types "http://localhost:3000/" in browser
         â†“
2. Browser sends GET request to server
         â†“
3. app.get('/') catches this request
         â†“
4. function(req, res) executes
         â†“
5. fs.readdir() reads the "./files" folder
         â†“ (wait for file system...)
6. function(err, files) receives the file list
         â†“
7. res.render() processes "index.ejs" with data
         â†“
8. EJS generates HTML
         â†“
9. Server sends HTML to browser
         â†“
10. User sees the webpage with file list!
```

### Visual Flow for Creating a File

```
1. User fills out form and clicks "Submit"
         â†“
2. Browser sends POST request to "/create"
         â†“
3. app.post('/create') catches the request
         â†“
4. express.urlencoded() parses form data
         â†“
5. req.body contains {title: "...", details: "..."}
         â†“
6. Remove spaces from title
         â†“
7. fs.writeFile() creates the file
         â†“ (wait for file system...)
8. File is saved
         â†“
9. res.redirect("/") sends user to homepage
         â†“
10. User sees updated file list!
```

---

## Project Structure

```
my-note-app/
â”‚
â”œâ”€â”€ node_modules/          # Installed packages (created by npm)
â”œâ”€â”€ public/                # Static files
â”‚   â”œâ”€â”€ style.css
â”‚   â””â”€â”€ script.js
â”‚
â”œâ”€â”€ views/                 # EJS templates
â”‚   â”œâ”€â”€ index.ejs         # Homepage template
â”‚   â””â”€â”€ show.ejs          # File view template
â”‚
â”œâ”€â”€ files/                 # Stores text files (user-created)
â”‚   â”œâ”€â”€ note1.txt
â”‚   â””â”€â”€ note2.txt
â”‚
â”œâ”€â”€ app.js                 # Main application file (your code)
â”œâ”€â”€ package.json           # Project info & dependencies
â””â”€â”€ package-lock.json      # Exact versions of dependencies
```

### Example EJS Templates

**views/index.ejs** (Homepage)
```html
<!DOCTYPE html>
<html>
<head>
    <title>My Notes</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <h1>All Notes</h1>
    
    <!-- Create new note form -->
    <form action="/create" method="POST">
        <input type="text" name="title" placeholder="Note title" required>
        <textarea name="details" placeholder="Note content" required></textarea>
        <button type="submit">Create Note</button>
    </form>
    
    <!-- List all files -->
    <ul>
        <% files.forEach(function(file) { %>
            <li>
                <a href="/files/<%= file %>"><%= file %></a>
            </li>
        <% }) %>
    </ul>
</body>
</html>
```

**views/show.ejs** (View File)
```html
<!DOCTYPE html>
<html>
<head>
    <title><%= filename %></title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <h1><%= filename %></h1>
    <p><%= filedata %></p>
    <a href="/">Back to all notes</a>
</body>
</html>
```

---

## How to Run

### 1. Install Node.js
Download from [nodejs.org](https://nodejs.org/)

### 2. Create Project

```bash
mkdir my-note-app
cd my-note-app
```

### 3. Initialize npm

```bash
npm init -y
```

### 4. Install Dependencies

```bash
npm install express ejs
```

### 5. Create Folder Structure

```bash
mkdir public views files
```

### 6. Create Files

- Create `app.js` with the code
- Create EJS templates in `views/`
- Optionally add CSS in `public/style.css`

### 7. Run the Application

```bash
node app.js
```

### 8. Visit in Browser

Open: `http://localhost:3000`

---

## Common Issues & Solutions

### Issue 1: "Cannot find module 'express'"
**Solution:** Run `npm install express ejs`

### Issue 2: "ENOENT: no such file or directory"
**Solution:** Create the `files` folder: `mkdir files`

### Issue 3: Port 3000 already in use
**Solution:** Change port number:
```javascript
app.listen(3001);  // Use different port
```

### Issue 4: EJS templates not found
**Solution:** Make sure templates are in `views/` folder and have `.ejs` extension

---

## Key Concepts Summary

| Concept | Explanation |
|---------|-------------|
| **Express** | Web framework for Node.js |
| **Routes** | URL patterns that trigger functions |
| **Middleware** | Functions that process requests |
| **Callbacks** | Functions passed as arguments, called later |
| **req (request)** | Object containing data from user |
| **res (response)** | Object used to send data back to user |
| **EJS** | Template engine to generate HTML |
| **async/await** | Modern way to handle asynchronous code |

---

## Next Steps to Learn

1. âœ… **Error Handling** - Handle file reading/writing errors properly
2. âœ… **Input Validation** - Check if user input is valid
3. âœ… **Edit/Delete** - Add routes to modify or remove files
4. âœ… **Database** - Replace file system with MongoDB/PostgreSQL
5. âœ… **Authentication** - Add user login/signup
6. âœ… **Deployment** - Deploy to Heroku, Vercel, or Railway

---

## Useful Resources

- [Express.js Official Docs](https://expressjs.com/)
- [Node.js Official Docs](https://nodejs.org/docs/)
- [EJS Documentation](https://ejs.co/)
- [MDN Web Docs - HTTP](https://developer.mozilla.org/en-US/docs/Web/HTTP)
- [JavaScript.info](https://javascript.info/)

---

**Remember:** The best way to learn is by building! Try modifying this code, add new features, break things and fix them. That's how you become a better developer! ðŸš€